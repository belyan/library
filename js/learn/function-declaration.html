<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Объявление функций</title>
</head>
<body>

<!--
Объявление функций
http://learn.javascript.ru/function-is-value
http://learn.javascript.ru/function-declaration-expression
http://learn.javascript.ru/named-function-expression
-->
<script>
    /* Функция — это значение */
    function sayHi(person) {
        console.log("Привет, " + person);
    }

    console.log(sayHi); // выведет код функции

    sayHi.test = 5;

    console.log(sayHi.test); // 5

    /* Копирование функций */
    var func = sayHi;

    console.log(func); // выведет код функции

    func("Вася"); // выведет "Привет, Вася"
    sayHi("Маша"); // и так по-прежнему работает: "Привет, Маша"

    // Function Expression
    var fe = function() { };

    // Function Declaration
    function fd() { }

    /* Объявление Function Declaration */
    // При объявлении функции создаётся переменная со значением-функцией
    function func2() {
        console.log(1);
    }

    var g = func2; // скопировали
    func2 = null;  // поменяли значение

    g(); // работает, теперь функция в g, а в func ничего нет
    try {
        func2(); // вызываем null()
    } catch(err) {
        console.log("ошибка!");
    }

    // Нонсенс!
    function f() { } // объявить переменную f и записать в нее функцию
    var f = 5; // объявить переменную f (а она уже объявлена) и присвоить 5

    console.log(f); // результат: 5

    /* Время создания Function Declaration */
    // Функции, объявленные как Function Declaration, создаются интерпретатором до выполнения кода
    sayHi2("Вася");

    function sayHi2(name) {
        console.log("Привет, " + name);
    }

    /* Объявление Function Expression */
    // Функцию можно создать и присвоить переменной как самое обычное значение
    var sayHi3 = function(person) {
        console.log("Привет, " + person);
    };

    sayHi3("Вася");

    var arr = [1, 2, function(a) { console.log(a) }, 3, 4];
    var fun = arr[2];
    fun(1); // 1

    // В отличие от объявлений Function Declaration, которые создаются заранее, до выполнения кода,
    // объявления Function Expression создают функцию, когда до них доходит выполнение
    var sayHi4 = function() {
        console.log(1)
    };

    sayHi4(); // 1

    var age = prompt("Сколько вам лет?");
    var sayHi5;

    if (age >= 18) {
        sayHi5 = function() { console.log("Вход разрешен"); }
    } else {
        sayHi5 = function() { console.log("Извините, вы слишком молоды"); }
    }

    sayHi5(); // запустит ту функцию, которая присвоена в if

    /* Функция с вызовом «на месте» */
    (function() {
        var a = 1 , b = 2;
        return a + b;
    })(); // функция объявлена и тут же вызвана

    // Скобки не нужны, если это и так Function Expression
    var res = function(a, b) {
        return a + b;
    }(2, 2);
    console.log(res); // 4

    // Но из соображений стиля и читаемости скобки вокруг function рекомендуется ставить
    var result = (function(a, b) {
        return a * b;
    })(2, 3);

    /* Named Function Expression */
    // Имя функционального выражения имеет особый смысл. Оно доступно только изнутри самой функции
    var f2 = function sayHi6(name) {
        console.log(sayHi6); // изнутри функции - видно (выведет код функции)
    };

    try{
        console.log(sayHi6); // снаружи - не видно
    } catch(err) {
        console.log("ошибка: undefined variable sayHi");
    }

    var test = function sayHi7() {
        sayHi7 = "тест";
        console.log(sayHi7); // function... (перезапись не удалась)
    };

    test();

    // Внутреннее имя позволяет функции надёжно обращаться к самой себе, где бы она ни находилась
    var f3 = function factorial(n) {
        return n ? n * factorial(n - 1) : 1;
    };

    var g2 = f3;  // скопировали ссылку на функцию-факториал в g
    f3 = null;

    console.log( g2(5) ); // 120, работает!

    /* Задача */
    function g3() { return 1; }
    console.log(g3); // function g3() { return 1; }

    (function g4() { return 1; });
    console.log(g4); // g4 is not defined
</script>

</body>
</html>